Address Translation - Homework



README:__________________________________________________________________________________

This program allows you to see how address translations are performed in a
system with base and bounds registers. As before, there are two steps to
running the program to test out your understanding of base and bounds. First,
run without the -c flag to generate a set of translations and see if you can
correctly perform the address translations yourself. Then, when done, run with
the -c flag to check your answers.

In this homework, we will assume a slightly different address space than our
canonical one with a heap and stack at opposite ends of the space. Rather, we
will assume that the address space has a code section, then a fixed-sized
(small) stack, and a heap that grows downward right after, looking something
like you see in the Figure below. In this configuration, there is only one
direction of growth, towards higher regions of the address space.

  -------------- 0KB
  |    Code    |
  -------------- 2KB
  |   Stack    |
  -------------- 4KB
  |    Heap    |
  |     |      |
  |     v      |
  -------------- 7KB
  |   (free)   |
  |     ...    |

In the figure, the bounds register would be set to 7~KB, as that represents
the end of the address space. References to any address within the bounds
would be considered legal; references above this value are out of bounds and
thus the hardware would raise an exception.

To run with the default flags, type relocation.py at the command line. The
result should be something like this:

prompt> ./relocation.py 
...
Base-and-Bounds register information:

  Base   : 0x00003082 (decimal 12418)
  Limit  : 472

Virtual Address Trace
  VA  0: 0x01ae (decimal:430) -> PA or violation?
  VA  1: 0x0109 (decimal:265) -> PA or violation?
  VA  2: 0x020b (decimal:523) -> PA or violation?
  VA  3: 0x019e (decimal:414) -> PA or violation?
  VA  4: 0x0322 (decimal:802) -> PA or violation?

For each virtual address, either write down the physical address it 
translates to OR write down that it is an out-of-bounds address 
(a segmentation violation). For this problem, you should assume a 
simple virtual address space of a given size.



As you can see, the homework simply generates randomized virtual
addresses. For each, you should determine whether it is in bounds, and if so,
determine to which physical address it translates. Running with -c (the
"compute this for me" flag) gives us the results of these translations, i.e.,
whether they are valid or not, and if valid, the resulting physical
addresses. For convenience, all numbers are given both in hex and decimal.

prompt> ./relocation.py -c
...
Virtual Address Trace
  VA  0: 0x01ae (decimal:430) -> VALID: 0x00003230 (dec:12848)
  VA  1: 0x0109 (decimal:265) -> VALID: 0x0000318b (dec:12683)
  VA  2: 0x020b (decimal:523) -> SEGMENTATION VIOLATION
  VA  3: 0x019e (decimal:414) -> VALID: 0x00003220 (dec:12832)
  VA  4: 0x0322 (decimal:802) -> SEGMENTATION VIOLATION


With a base address of 12418 (decimal), address 430 is within bounds (i.e., it
is less than the limit register of 472) and thus translates to 430 added to
12418 or 12848. A few of the addresses shown above are out of bounds (523,
802), as they are in excess of the bounds. Pretty simple, no? Indeed, that is
one of the beauties of base and bounds: it's so darn simple!



There are a few flags you can use to control what's going on better:

prompt> ./relocation.py -h
Usage: relocation.py [options]

Options:
  -h, 	    --help            	show this help message and exit
  -s SEED,  --seed=SEED  	the random seed
  -a ASIZE, --asize=ASIZE 	address space size (e.g., 16, 64k, 32m)
  -p PSIZE, --physmem=PSIZE 	physical memory size (e.g., 16, 64k)
  -n NUM,   --addresses=NUM 	# of virtual addresses to generate
  -b BASE,  --b=BASE     	value of base register
  -l LIMIT, --l=LIMIT   	value of limit register
  -c, --compute         	compute answers for me
]

In particular, you can control the virtual address-space size (-a), the size
of physical memory (-p), the number of virtual addresses to generate (-n), and
the values of the base and bounds registers for this process (-b and -l,
respectively).







1.
Run with seeds 1, 2, and 3, and compute whether each virtual address generated by the process 
is in or out of bounds. 
If in bounds, compute the translation.
*For each virtual address, either write down the physical address it translates to
OR write down that it is an out-of-bounds address (a segmentation violation)*
-------------------------------------------------------seed = 1
ARG seed 1
ARG address space size 1k
ARG phys mem size 16k

Base-and-Bounds register information:

  Base   : 0x0000363c (decimal 13884)
  Limit  : 290

Virtual Address Trace
  VA  0: 0x0000030e (decimal:  782) --> PA or segmentation violation?
  VA  1: 0x00000105 (decimal:  261) --> PA or segmentation violation?
  VA  2: 0x000001fb (decimal:  507) --> PA or segmentation violation?
  VA  3: 0x000001cc (decimal:  460) --> PA or segmentation violation?
  VA  4: 0x0000029b (decimal:  667) --> PA or segmentation violation?

------------------------------------SOLUTION
VA 0: Segementation violation
VA 1: VALID: base (= 13884) + virtual address (= 261) = physical address (= 14145) - 0x00003741
VA 2: Segementation violation
VA 3: Segementation violation
VA 4: Segementation violation

-------------------------------------------------------seed = 2
ARG seed 2
ARG address space size 1k
ARG phys mem size 16k

Base-and-Bounds register information:

  Base   : 0x00003ca9 (decimal 15529)
  Limit  : 500

Virtual Address Trace
  VA  0: 0x00000039 (decimal:   57) --> PA or segmentation violation?
  VA  1: 0x00000056 (decimal:   86) --> PA or segmentation violation?
  VA  2: 0x00000357 (decimal:  855) --> PA or segmentation violation?
  VA  3: 0x000002f1 (decimal:  753) --> PA or segmentation violation?
  VA  4: 0x000002ad (decimal:  685) --> PA or segmentation violation?

------------------------------------SOLUTION
VA 0: VALID: 0x00003ce2 (decimal: 15586)
VA 1: VALID: 0x00003cff (decimal: 15615)
VA 2: Segementation violation
VA 3: Segementation violation
VA 4: Segementation violation

-------------------------------------------------------seed = 3
ARG seed 3
ARG address space size 1k
ARG phys mem size 16k

Base-and-Bounds register information:

  Base   : 0x000022d4 (decimal 8916)
  Limit  : 316

Virtual Address Trace
  VA  0: 0x0000017a (decimal:  378) --> PA or segmentation violation?
  VA  1: 0x0000026a (decimal:  618) --> PA or segmentation violation?
  VA  2: 0x00000280 (decimal:  640) --> PA or segmentation violation?
  VA  3: 0x00000043 (decimal:   67) --> PA or segmentation violation?
  VA  4: 0x0000000d (decimal:   13) --> PA or segmentation violation?
------------------------------------SOLUTION
VA 0: Segementation violation
VA 1: Segementation violation
VA 2: Segementation violation
VA 3: VALID: 0x00002317 (decimal: 8983)
VA 4: VALID: 0x000022e1 (decimal: 8929) 







2.
Run with these ﬂags: -s 0 -n 10. 
What value do you have set -l (the bounds register) to in order to ensure 
that all the generated virtual addresses are within bounds?
------------------------------------------------------------------------
-n : number of virtual addresses to generate
---------------------------------------------
ARG seed 0
ARG address space size 1k
ARG phys mem size 16k

Base-and-Bounds register information:

  Base   : 0x00003082 (decimal 12418)
  Limit  : 472

Virtual Address Trace
  VA  0: 0x000001ae (decimal:  430) --> PA or segmentation violation?
  VA  1: 0x00000109 (decimal:  265) --> PA or segmentation violation?
  VA  2: 0x0000020b (decimal:  523) --> PA or segmentation violation?
  VA  3: 0x0000019e (decimal:  414) --> PA or segmentation violation?
  VA  4: 0x00000322 (decimal:  802) --> PA or segmentation violation?
  VA  5: 0x00000136 (decimal:  310) --> PA or segmentation violation?
  VA  6: 0x000001e8 (decimal:  488) --> PA or segmentation violation?
  VA  7: 0x00000255 (decimal:  597) --> PA or segmentation violation?
  VA  8: 0x000003a1 (decimal:  929) --> PA or segmentation violation?
  VA  9: 0x00000204 (decimal:  516) --> PA or segmentation violation?
-------------------------------------------SOLUTION
-l has to be 930 (max + 1)

  VA  0: VALID: 0x00003913 (decimal: 14611)
  VA  1: VALID: 0x000037b9 (decimal: 14265)
  VA  2: VALID: 0x00003714 (decimal: 14100)
  VA  3: VALID: 0x00003816 (decimal: 14358)
  VA  4: VALID: 0x000037a9 (decimal: 14249)
  VA  5: VALID: 0x0000392d (decimal: 14637)
  VA  6: VALID: 0x00003741 (decimal: 14145)
  VA  7: VALID: 0x000037f3 (decimal: 14323)
  VA  8: VALID: 0x00003860 (decimal: 14432)
  VA  9: VALID: 0x000039ac (decimal: 14764)






3. (???)
Run with these ﬂags: -s 1 -n 10 -l 100. 
What is the maximum value that base can be set to, such that 
the address space still ﬁts into physical memory in its entirety?
---------------------------------------------
ARG seed 1
ARG address space size 1k
ARG phys mem size 16k

Base-and-Bounds register information:

  Base   : 0x00000899 (decimal 2201)
  Limit  : 100

Virtual Address Trace
  VA  0: 0x00000363 (decimal:  867) --> PA or segmentation violation?
  VA  1: 0x0000030e (decimal:  782) --> PA or segmentation violation?
  VA  2: 0x00000105 (decimal:  261) --> PA or segmentation violation?
  VA  3: 0x000001fb (decimal:  507) --> PA or segmentation violation?
  VA  4: 0x000001cc (decimal:  460) --> PA or segmentation violation?
  VA  5: 0x0000029b (decimal:  667) --> PA or segmentation violation?
  VA  6: 0x00000327 (decimal:  807) --> PA or segmentation violation?
  VA  7: 0x00000060 (decimal:   96) --> PA or segmentation violation?
  VA  8: 0x0000001d (decimal:   29) --> PA or segmentation violation?
  VA  9: 0x00000357 (decimal:  855) --> PA or segmentation violation?
-----------------------------SOLUTION
2^14 = 16k
16k - 100 = 16284
(physical memory size - limit)








